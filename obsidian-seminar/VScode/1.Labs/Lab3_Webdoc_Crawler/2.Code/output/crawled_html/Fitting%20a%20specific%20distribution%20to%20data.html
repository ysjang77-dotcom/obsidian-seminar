<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div itemprop="articleBody">
<img alt="_images/logo.png" src="_images/logo.png"/>
<hr class="docutils"/>
<section id="fitting-a-specific-distribution-to-data">
<h1>Fitting a specific distribution to data<a class="headerlink" href="#fitting-a-specific-distribution-to-data" title="Link to this heading"></a></h1>
<div class="admonition-api-reference admonition">
<p class="admonition-title">API Reference</p>
<p>For inputs and outputs see the <a class="reference external" href="https://reliability.readthedocs.io/en/latest/API/Fitters.html">API reference</a>.</p>
</div>
<p>The module <cite>reliability.Fitters</cite> provides many probability distribution fitting functions as shown below.</p>
<p>Functions for fitting non-location shifted distributions:</p>
<ul class="simple">
<li><p>Fit_Exponential_1P</p></li>
<li><p>Fit_Weibull_2P</p></li>
<li><p>Fit_Gamma_2P</p></li>
<li><p>Fit_Lognormal_2P</p></li>
<li><p>Fit_Loglogistic_2P</p></li>
<li><p>Fit_Normal_2P</p></li>
<li><p>Fit_Gumbel_2P</p></li>
<li><p>Fit_Beta_2P</p></li>
</ul>
<p>Functions for fitting location shifted distributions:</p>
<ul class="simple">
<li><p>Fit_Exponential_2P</p></li>
<li><p>Fit_Weibull_3P</p></li>
<li><p>Fit_Gamma_3P</p></li>
<li><p>Fit_Lognormal_3P</p></li>
<li><p>Fit_Loglogistic_3P</p></li>
</ul>
<p>All of the distributions can be fitted to both complete and incomplete (right censored) data. All distributions in the Fitters module are named with their number of parameters (eg. Fit_Weibull_2P uses α,β, whereas Fit_Weibull_3P uses α,β,γ). This is intended to remove ambiguity about what distribution you are fitting.</p>
<p>Distributions are fitted simply by using the desired function and specifying the data as failures or right_censored data. You must have at least as many failures as there are distribution parameters or the fit would be under-constrained. It is generally advisable to have at least 4 data points as the accuracy of the fit is proportional to the amount of data. Once fitted, the results are assigned to an object and the fitted parameters can be accessed by name, as shown in the examples below. The goodness of fit criterions are also available as AICc (Akaike Information Criterion corrected), BIC (Bayesian Information Criterion), AD (Anderson-Darling), and loglik (log-likelihood), though these are more useful when comparing the fit of multiple distributions such as in the <a class="reference external" href="https://reliability.readthedocs.io/en/latest/Fitting%20all%20available%20distributions%20to%20data.html">Fit_Everything</a> function. As a matter of convenience, each of the modules in Fitters also generates a distribution object that has the parameters of the fitted distribution.</p>
<p>The Beta distribution is only for data in the range 0 to 1. Specifying data outside of this range will cause an error. The fitted Beta distribution does not include confidence intervals.</p>
<p>If you have a very large amount of data (&gt;100000 samples) then it is likely that your computer will take significant time to compute the results. This is a limitation of interpreted languages like Python compared to compiled languages like C++ which many commerial reliability software packages are written in. If you have very large volumes of data, you may want to consider using commercial software for faster computation time. The function Fit_Weibull_2P_grouped is designed to accept a dataframe which has multiple occurrences of some values (eg. multiple values all right censored to the same value when the test was ended). Depending on the size of the data set and the amount of grouping in your data, Fit_Weibull_2P_grouped may be much faster than Fit_Weibull_2P and achieve the same level of accuracy. This difference is not noticable if you have less than 10000 samples. For more information, see the example below on <a class="reference external" href="https://reliability.readthedocs.io/en/latest/Fitting%20a%20specific%20distribution%20to%20data.html#using-fit-weibull-2p-grouped-for-large-data-sets">using Fit_Weibull_2P_grouped</a>.</p>
<p>Heavily censored data (&gt;99.9% censoring) may result in a failure of the optimizer to find a solution. If you have heavily censored data, you may have a limited failure population problem. It is recommended that you do not try fitting one of these standard distributions to such a dataset as your results (while they may have achieved a successful fit) will be a poor description of your overall population statistic and you risk drawing the wrong conclusions when the wrong model is fitted. The limited failure population model is planned for a future release of <em>reliability</em>, though development on this model is yet to commence. In the meantime, see JMP Pro’s model for <a class="reference external" href="https://www.jmp.com/en_my/events/ondemand/statistical-methods-in-reliability/defective-subpopulation-distributions.html">Defective Subpopulations.</a></p>
<p>If you do not know which distribution you want to fit, then please see the <a class="reference external" href="https://reliability.readthedocs.io/en/latest/Fitting%20all%20available%20distributions%20to%20data.html">section</a> on using the Fit_Everything function which will find the best distribution to describe your data. It is highly recommended that you always try to fit everything and accept the best fit rather than choosing a particular distribution for subjective reasons.</p>
<p>If you have tried fitting multiple distributions and nothing seems to work well, or you can see the scatter points on the probability plot have an S-shape or a bend, then you may have data from a mixture of sources. In this case consider fitting a <a class="reference external" href="https://reliability.readthedocs.io/en/latest/Mixture%20models.html">Mixture model</a> or a <a class="reference external" href="https://reliability.readthedocs.io/en/latest/Competing%20risk%20models.html">Competing Risks Model</a>.</p>
<section id="example-1">
<h2>Example 1<a class="headerlink" href="#example-1" title="Link to this heading"></a></h2>
<p>To learn how we can fit a distribution, we will start by using a simple example with 30 failure times. These times were generated from a Weibull distribution with α=50, β=3. Note that the output also provides the confidence intervals and standard error of the parameter estimates. The probability plot is generated be default (you will need to specify plt.show() to show it). See the section on <a class="reference external" href="https://reliability.readthedocs.io/en/latest/Probability%20plots.html#what-does-a-probability-plot-show-me">probability plotting</a> to learn how to interpret this plot.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Fitters</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fit_Weibull_2P</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">58</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">73</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">82</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">66</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">25</span><span class="p">]</span> <span class="c1"># made using Weibull Distribution(alpha=50,beta=3)</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">Fit_Weibull_2P</span><span class="p">(</span><span class="n">failures</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="sd">'''</span>
<span class="sd">Results from Fit_Weibull_2P (95% CI):</span>
<span class="sd">Analysis method: Maximum Likelihood Estimation (MLE)</span>
<span class="sd">Optimizer: TNC</span>
<span class="sd">Failures / Right censored: 30/0 (0% right censored)</span>

<span class="sd">Parameter  Point Estimate  Standard Error  Lower CI  Upper CI</span>
<span class="sd">    Alpha          51.858         3.55628   45.3359   59.3183</span>
<span class="sd">     Beta         2.80086         0.41411   2.09624   3.74233</span>

<span class="sd">Goodness of fit    Value</span>
<span class="sd"> Log-likelihood -129.063</span>
<span class="sd">           AICc   262.57</span>
<span class="sd">            BIC  264.928</span>
<span class="sd">             AD 0.759805</span>
<span class="sd">'''</span>
</pre></div>
</div>
<img alt="_images/Fit_Weibull_2P_V4.png" src="_images/Fit_Weibull_2P_V4.png"/>
<p>The above probability plot is the typical way to visualise how the CDF (the blue line) models the failure data (the black points). If you would like to view the failure points alongside the PDF, CDF, SF, HF, or CHF without the axis being scaled then you can generate the scatter plot using the function plot_points which is available within reliability.Probability_plotting. In the example below we create some data, then fit a Weibull distribution to the data (ensuring we turn off the probability plot). From the fitted distribution object we plot the Survival Function (SF). We then use plot_points to generate a scatter plot of the plotting positions for the survival function.</p>
<div class="admonition-api-reference admonition">
<p class="admonition-title">API Reference</p>
<p>For inputs and outputs of the plot_points function see the <a class="reference external" href="https://reliability.readthedocs.io/en/latest/API/Probability_plotting/plot_points.html">API reference</a>.</p>
</div>
</section>
<section id="example-2">
<h2>Example 2<a class="headerlink" href="#example-2" title="Link to this heading"></a></h2>
<p>This example shows how to use the plot_points function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Distributions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Weibull_Distribution</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Fitters</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fit_Weibull_2P</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Probability_plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_points</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">Weibull_Distribution</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">random_samples</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">weibull_fit</span> <span class="o">=</span> <span class="n">Fit_Weibull_2P</span><span class="p">(</span><span class="n">failures</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">show_probability_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">print_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">weibull_fit</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">SF</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">'Fitted Distribution'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'steelblue'</span><span class="p">)</span>
<span class="n">plot_points</span><span class="p">(</span><span class="n">failures</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">func</span><span class="o">=</span><span class="s1">'SF'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'failure data'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/plot_points_V4.png" src="_images/plot_points_V4.png"/>
</section>
<section id="example-3">
<h2>Example 3<a class="headerlink" href="#example-3" title="Link to this heading"></a></h2>
<p>It is beneficial to see the effectiveness of the fitted distribution in comparison to the original distribution. In this example, we are creating 500 samples from a Weibull distribution and then we will right censor all of the data above our chosen threshold. Then we are fitting a Weibull_3P distribution to the data. Note that we need to specify “show_probability_plot=False, print_results=False” in the Fit_Weibull_3P to prevent the normal outputs of the fitting function from being displayed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Distributions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Weibull_Distribution</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Fitters</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fit_Weibull_3P</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Other_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_right_censored_data</span><span class="p">,</span> <span class="n">histogram</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">a</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">g</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">threshold</span><span class="o">=</span><span class="mi">55</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">Weibull_Distribution</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">g</span><span class="p">)</span> <span class="c1"># generate a weibull distribution</span>
<span class="n">raw_data</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">random_samples</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># create some data from the distribution</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">make_right_censored_data</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span><span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span> <span class="c1">#right censor some of the data</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'There are'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">right_censored</span><span class="p">),</span> <span class="s1">'right censored items.'</span><span class="p">)</span>
<span class="n">wbf</span> <span class="o">=</span> <span class="n">Fit_Weibull_3P</span><span class="p">(</span><span class="n">failures</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">failures</span><span class="p">,</span> <span class="n">right_censored</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">right_censored</span><span class="p">,</span> <span class="n">show_probability_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">print_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># fit the Weibull_3P distribution</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Fit_Weibull_3P parameters:</span><span class="se">\n</span><span class="s1">Alpha:'</span><span class="p">,</span> <span class="n">wbf</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">Beta:'</span><span class="p">,</span> <span class="n">wbf</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">Gamma'</span><span class="p">,</span> <span class="n">wbf</span><span class="o">.</span><span class="n">gamma</span><span class="p">)</span>
<span class="n">histogram</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span><span class="n">white_above</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span> <span class="c1"># generates the histogram using optimal bin width and shades the censored part as white</span>
<span class="n">dist</span><span class="o">.</span><span class="n">PDF</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">'True Distribution'</span><span class="p">)</span>  <span class="c1"># plots the true distribution's PDF</span>
<span class="n">wbf</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">PDF</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">'Fit_Weibull_3P'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">)</span>  <span class="c1"># plots to PDF of the fitted Weibull_3P</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Fitting comparison for failures and right censored data'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="sd">'''</span>
<span class="sd">There are 118 right censored items.</span>
<span class="sd">Fit_Weibull_3P parameters:</span>
<span class="sd">Alpha: 28.874745169627886</span>
<span class="sd">Beta: 2.0294944619390654</span>
<span class="sd">Gamma 20.383959629725744</span>
<span class="sd">'''</span>
</pre></div>
</div>
<img alt="_images/Fit_Weibull_3P_right_cens_V5.png" src="_images/Fit_Weibull_3P_right_cens_V5.png"/>
</section>
<section id="example-4">
<h2>Example 4<a class="headerlink" href="#example-4" title="Link to this heading"></a></h2>
<p>As another example, we will fit a Gamma_2P distribution to some partially right censored data. To provide a comparison of the fitting accuracy as the number of samples increases, we will do the same experiment with varying sample sizes. The results highlight that the accuracy of the fit is proportional to the amount of samples, so you should always try to obtain more data if possible.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Distributions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gamma_Distribution</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Fitters</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fit_Gamma_2P</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Other_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_right_censored_data</span><span class="p">,</span> <span class="n">histogram</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">a</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mi">180</span>  <span class="c1"># this is used when right censoring the data</span>
<span class="n">trials</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">]</span>
<span class="n">subplot_id</span> <span class="o">=</span> <span class="mi">221</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="k">for</span> <span class="n">sample_size</span> <span class="ow">in</span> <span class="n">trials</span><span class="p">:</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">Gamma_Distribution</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
    <span class="n">raw_data</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">random_samples</span><span class="p">(</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># create some data. Seeded for repeatability</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">make_right_censored_data</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>  <span class="c1"># right censor the data</span>
    <span class="n">gf</span> <span class="o">=</span> <span class="n">Fit_Gamma_2P</span><span class="p">(</span><span class="n">failures</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">failures</span><span class="p">,</span> <span class="n">right_censored</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">right_censored</span><span class="p">,</span> <span class="n">show_probability_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">print_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># fit the Gamma_2P distribution</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Fit_Gamma_2P parameters using'</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="s1">'samples:'</span><span class="p">,</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">Alpha:'</span><span class="p">,</span> <span class="n">gf</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">Beta:'</span><span class="p">,</span> <span class="n">gf</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span>  <span class="c1"># print the results</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">subplot_id</span><span class="p">)</span>
    <span class="n">histogram</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span><span class="n">white_above</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span> <span class="c1"># plots the histogram using optimal bin width and shades the right censored part white</span>
    <span class="n">dist</span><span class="o">.</span><span class="n">PDF</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">'True'</span><span class="p">)</span>  <span class="c1"># plots the true distribution</span>
    <span class="n">gf</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">PDF</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">'Fitted'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">)</span>  <span class="c1"># plots the fitted Gamma_2P distribution</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sample_size</span><span class="p">)</span> <span class="o">+</span> <span class="s1">' samples</span><span class="se">\n</span><span class="s1">'</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">'$\alpha$ error: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">gf</span><span class="o">.</span><span class="n">alpha</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">'%</span><span class="se">\n</span><span class="s1">'</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">'$\beta$ error: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">gf</span><span class="o">.</span><span class="n">beta</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">b</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">'%'</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.012</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">subplot_id</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.89</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.58</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="sd">'''</span>
<span class="sd">Fit_Gamma_2P parameters using 10 samples:</span>
<span class="sd">Alpha: 19.42603577754394</span>
<span class="sd">Beta: 4.6901283424759255</span>

<span class="sd">Fit_Gamma_2P parameters using 100 samples:</span>
<span class="sd">Alpha: 36.26411284656554</span>
<span class="sd">Beta: 3.2929448936077534</span>

<span class="sd">Fit_Gamma_2P parameters using 1000 samples:</span>
<span class="sd">Alpha: 28.825423280158407</span>
<span class="sd">Beta: 4.062909060146121</span>

<span class="sd">Fit_Gamma_2P parameters using 10000 samples:</span>
<span class="sd">Alpha: 30.301232862075587</span>
<span class="sd">Beta: 3.96009153189253</span>
<span class="sd">'''</span>
</pre></div>
</div>
<img alt="_images/Fit_Gamma_2P_right_cens_V5.png" src="_images/Fit_Gamma_2P_right_cens_V5.png"/>
</section>
<section id="example-5">
<h2>Example 5<a class="headerlink" href="#example-5" title="Link to this heading"></a></h2>
<p>To obtain details of the quantiles (y-values from the CDF) which include the lower estimate, point estimate, and upper estimate, we can use the quantiles input for each Fitter. In this example, we will create some data and fit a Weibull_2P distribution. When quantiles is specified the results printed includes both the table of results and the table of quantiles. Setting quantiles as True will use a default list of quantiles (as shown in the first output). Alternatively we can specify the exact quantiles to use (as shown in the second output). The use of the <a class="reference external" href="https://reliability.readthedocs.io/en/latest/Crosshairs.html">crosshairs</a> function is also shown which was used to annotate the plot manually. Note that the quantiles provided are the quantiles of the confidence bounds on time. You can extract the confidence bounds on on reliability using the fitted distribution object as shown <a class="reference external" href="https://reliability.readthedocs.io/en/latest/Working%20with%20fitted%20distributions.html">here</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Distributions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Weibull_Distribution</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Fitters</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fit_Weibull_2P</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Other_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">crosshairs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">dist</span> <span class="o">=</span> <span class="n">Weibull_Distribution</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">random_samples</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># generate some data</span>
<span class="c1"># this will produce the large table of quantiles below the first table of results</span>
<span class="n">Fit_Weibull_2P</span><span class="p">(</span><span class="n">failures</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">quantiles</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">CI</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">show_probability_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'----------------------------------------------------------'</span><span class="p">)</span>
<span class="c1"># repeat the process but using specified quantiles.</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">Fit_Weibull_2P</span><span class="p">(</span><span class="n">failures</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">],</span> <span class="n">CI</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="c1"># these points have been manually annotated on the plot using crosshairs</span>
<span class="n">crosshairs</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># the values from the quantiles dataframe can be extracted using pandas:</span>
<span class="n">lower_estimates</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">quantiles</span><span class="p">[</span><span class="s1">'Lower Estimate'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Lower estimates:'</span><span class="p">,</span> <span class="n">lower_estimates</span><span class="p">)</span>

<span class="c1">#alternatively, the bounds can be extracted from the distribution object</span>
<span class="n">lower</span><span class="p">,</span><span class="n">point</span><span class="p">,</span><span class="n">upper</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">CDF</span><span class="p">(</span><span class="n">CI_y</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">],</span> <span class="n">CI</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Upper estimates:'</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>

<span class="sd">'''</span>
<span class="sd">Results from Fit_Weibull_2P (80% CI):</span>
<span class="sd">Analysis method: Maximum Likelihood Estimation (MLE)</span>
<span class="sd">Optimizer: TNC</span>
<span class="sd">Failures / Right censored: 50/0 (0% right censored)</span>

<span class="sd">Parameter  Point Estimate  Standard Error  Lower CI  Upper CI</span>
<span class="sd">    Alpha         489.117         13.9217   471.597   507.288</span>
<span class="sd">     Beta         5.20798        0.589269     4.505   6.02066</span>

<span class="sd">Goodness of fit    Value</span>
<span class="sd"> Log-likelihood -301.658</span>
<span class="sd">           AICc  607.571</span>
<span class="sd">            BIC   611.14</span>
<span class="sd">             AD  0.48267</span>

<span class="sd">Table of quantiles (80% CI bounds on time):</span>
<span class="sd"> Quantile  Lower Estimate  Point Estimate  Upper Estimate</span>
<span class="sd">     0.01         175.215         202.212         233.368</span>
<span class="sd">     0.05         250.235         276.521         305.569</span>
<span class="sd">      0.1         292.686         317.508         344.435</span>
<span class="sd">      0.2         344.277         366.719         390.623</span>
<span class="sd">     0.25         363.578          385.05          407.79</span>
<span class="sd">      0.5          437.69         455.879         474.824</span>
<span class="sd">     0.75          502.94         520.776         539.245</span>
<span class="sd">      0.8         517.547         535.917         554.938</span>
<span class="sd">      0.9         553.267         574.068         595.651</span>
<span class="sd">     0.95         580.174          603.82          628.43</span>
<span class="sd">     0.99         625.682          655.79         687.347</span>

<span class="sd">----------------------------------------------------------</span>
<span class="sd">Results from Fit_Weibull_2P (80% CI):</span>
<span class="sd">Analysis method: Maximum Likelihood Estimation (MLE)</span>
<span class="sd">Optimizer: TNC</span>
<span class="sd">Failures / Right censored: 50/0 (0% right censored)</span>

<span class="sd">Parameter  Point Estimate  Standard Error  Lower CI  Upper CI</span>
<span class="sd">    Alpha         489.117         13.9217   471.597   507.288</span>
<span class="sd">     Beta         5.20798        0.589269     4.505   6.02066</span>

<span class="sd">Goodness of fit    Value</span>
<span class="sd"> Log-likelihood -301.658</span>
<span class="sd">           AICc  607.571</span>
<span class="sd">            BIC   611.14</span>
<span class="sd">             AD  0.48267</span>

<span class="sd">Table of quantiles (80% CI bounds on time):</span>
<span class="sd"> Quantile  Lower Estimate  Point Estimate  Upper Estimate</span>
<span class="sd">     0.05         250.235         276.521         305.569</span>
<span class="sd">      0.5          437.69         455.879         474.824</span>
<span class="sd">     0.95         580.174          603.82          628.43</span>

<span class="sd">Lower estimates: [250.23461473 437.69015375 580.17421254]</span>
<span class="sd">Upper estimates: [305.56872227 474.82362169 628.43042835]</span>
<span class="sd">'''</span>
</pre></div>
</div>
<img alt="_images/weibull_percentiles.png" src="_images/weibull_percentiles.png"/>
</section>
<section id="using-fit-weibull-2p-grouped-for-large-data-sets">
<h2>Using Fit_Weibull_2P_grouped for large data sets<a class="headerlink" href="#using-fit-weibull-2p-grouped-for-large-data-sets" title="Link to this heading"></a></h2>
<p>The function Fit_Weibull_2P_grouped is effectively the same as Fit_Weibull_2P, except for a few small differences that make it more efficient at handling grouped data sets. Grouped data sets are typically found in very large data that may be heavily censored. The function includes a choice between two optimizers and a choice between two initial guess methods for the initial guess that is given to the optimizer. These help in cases where the data is very heavily censored (&gt;99.9%). The defaults for these options are usually the best but you may want to try different options to see which one gives you the lowest log-likelihood.</p>
<div class="admonition-api-reference admonition">
<p class="admonition-title">API Reference</p>
<p>For inputs and outputs see the <a class="reference external" href="https://reliability.readthedocs.io/en/latest/API/Fitters/Fit_Weibull_2P_grouped.html">API reference</a>.</p>
</div>
</section>
<section id="example-6">
<h2>Example 6<a class="headerlink" href="#example-6" title="Link to this heading"></a></h2>
<p>The following example shows how we can use Fit_Weibull_2P_grouped to fit a Weibull_2P distribution to grouped data from a spreadsheet (shown below) on the Windows desktop. If you would like to access this data, it is available in reliability.Datasets.electronics and includes both the failures and right_censored format as well as the dataframe format. An example of this is provided in the code below (option 2).</p>
<img alt="_images/grouped_excel.png" src="_images/grouped_excel.png"/>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Fitters</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fit_Weibull_2P_grouped</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># option 1 for importing this dataset (from an excel file on your desktop)</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">'C:</span><span class="se">\\</span><span class="s1">Users</span><span class="se">\\</span><span class="s1">Current User</span><span class="se">\\</span><span class="s1">Desktop</span><span class="se">\\</span><span class="s1">data.xlsx'</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">io</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>

<span class="c1">## option 2 for importing this dataset (from the dataset in reliability)</span>
<span class="c1"># from reliability.Datasets import electronics</span>
<span class="c1"># df = electronics().dataframe</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="n">Fit_Weibull_2P_grouped</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">show_probability_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="sd">'''</span>
<span class="sd">     time  quantity category</span>
<span class="sd">0     220         1        F</span>
<span class="sd">1     179         1        F</span>
<span class="sd">2     123         1        F</span>
<span class="sd">3     146         1        F</span>
<span class="sd">4     199         1        F</span>
<span class="sd">5     181         1        F</span>
<span class="sd">6     191         1        F</span>
<span class="sd">7     216         1        F</span>
<span class="sd">8       1         1        F</span>
<span class="sd">9      73         1        F</span>
<span class="sd">10  44798       817        C</span>
<span class="sd">11  62715       823        C</span>
<span class="sd">12  81474       815        C</span>
<span class="sd">13  80632       813        C</span>
<span class="sd">14  62716       804        C</span>

<span class="sd">Results from Fit_Weibull_2P_grouped (95% CI):</span>
<span class="sd">Analysis method: Maximum Likelihood Estimation (MLE)</span>
<span class="sd">Optimizer: TNC</span>
<span class="sd">Failures / Right censored: 10/4072 (99.75502% right censored)</span>

<span class="sd">Parameter  Point Estimate  Standard Error    Lower CI    Upper CI</span>
<span class="sd">    Alpha     6.19454e+21      7.7592e+22 1.34889e+11 2.84473e+32</span>
<span class="sd">     Beta        0.153742       0.0485886   0.0827523    0.285632</span>

<span class="sd">Goodness of fit    Value</span>
<span class="sd"> Log-likelihood -144.617</span>
<span class="sd">           AICc  293.236</span>
<span class="sd">            BIC  305.862</span>
<span class="sd">             AD  264.999</span>
<span class="sd">'''</span>
</pre></div>
</div>
</section>
</section>
</div>
</div>