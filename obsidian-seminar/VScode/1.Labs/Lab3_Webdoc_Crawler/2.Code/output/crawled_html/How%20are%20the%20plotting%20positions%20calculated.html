<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div itemprop="articleBody">
<img alt="_images/logo.png" src="_images/logo.png"/>
<hr class="docutils"/>
<section id="how-are-the-plotting-positions-calculated">
<h1>How are the plotting positions calculated<a class="headerlink" href="#how-are-the-plotting-positions-calculated" title="Link to this heading"></a></h1>
<p>When we want to fit a probability distribution to a dataset (such as failure times), there are a variety of methods we can use.
The most popular of these methods are Least Squares estimation (LS) and Maximum Likelihood Estimation (MLE).
As a prerequisite to Least Squares Estimation, we need an estimate of the CDF (y-values) for a given dataset (x-values).
Once we have both the x-values and the y-values we can plot the points (x,y) on a graph.
These are called the plotting positions.</p>
<p>There are a variety of different algorithms for obtaining the plotting positions, but the most popular is the rank adjustment method which will be described in detail below.
To introduce the algorithm, we will start with complete data (ie. no censoring) and then we will see how the algorithm needs to be modified when we have censored data.</p>
<section id="rank-adjustment-for-complete-data">
<h2>Rank adjustment for complete data<a class="headerlink" href="#rank-adjustment-for-complete-data" title="Link to this heading"></a></h2>
<p>The plotting positions algorithm for complete data is as follows:</p>
<ol class="arabic simple">
<li><p>sort the data in ascending order</p></li>
<li><p>create a column (i) for the rank from 1 to n.</p></li>
<li><p>estimate the CDF using <span class="math notranslate nohighlight">\(y=\frac{i-a}{n+1-2a}\)</span>.</p></li>
</ol>
<p>Where “n” is the number of items (len(x)) and “a” is the heuristic constant. For this example we will let a = 0.3 which will give Benard’s approximation of the median rank plotting positions (the default in most software). Other heuristics are discussed below.
Something you may notice about the formula for y is that it is independent of x. You will always obtain the same y values for any array of x values of the same length.</p>
<p>Let’s do an example using the dataset x = [25, 43, 53, 65, 76, 86, 95, 115, 132, 150]</p>
<img alt="_images/plotting_positions_1.PNG" src="_images/plotting_positions_1.PNG"/>
<p>We can now plot the x and y values to obtain the plotting positions as shown in the image below.
The dashed blue line is a Weibull_2P distribution that has been fitted to the data.
This is just for illustrative purposes to show that the empirical CDF (the calculated y-values) and the CDF of the fitted model should roughly align.</p>
<img alt="_images/plotting_positions_2.png" src="_images/plotting_positions_2.png"/>
</section>
<section id="rank-adjustment-for-censored-data">
<h2>Rank adjustment for censored data<a class="headerlink" href="#rank-adjustment-for-censored-data" title="Link to this heading"></a></h2>
<p>The algorithm above provides the rank (i) simply by using the item number (1 to n) when the x-values are sorted.
When we have right censored data, the ranks need to be adjusted using a few modifications to the original algorithm.
The rank adjustment algorithm for right censored data is as follows:</p>
<ol class="arabic simple">
<li><p>sort the data in ascending order</p></li>
<li><p>create a column (i) for the rank from 1 to n.</p></li>
<li><p>create a column (m) of the reverse rank from n to 1.</p></li>
<li><p>calculate the adjusted rank as <span class="math notranslate nohighlight">\(j_i = j_{i-1}+\frac{n+1-j_{i-1}}{1+m}\)</span>. If the first item is a failure, then the adjusted rank of the first failure is j_1 = 1. If the first item is not a failure, the the adjusted rank of the first failure is <span class="math notranslate nohighlight">\(j_1=\frac{\textrm{number of leading censored values}}{n - 1}\)</span>. Leave the rows with censored items blank.</p></li>
<li><p>estimate the CDF using <span class="math notranslate nohighlight">\(y=\frac{j-a}{n+1-2a}\)</span>.</p></li>
</ol>
<p>Let’s do an example using the dataset x = [150, 340+, 560, 800, 1130+, 1720, 2470+, 4210+, 5230, 6890]. In this dataset the values with + are right censored.</p>
<img alt="_images/plotting_positions_3.PNG" src="_images/plotting_positions_3.PNG"/>
<p>You can check this using Python like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Probability_plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plotting_positions</span>
<span class="n">failures</span> <span class="o">=</span> <span class="p">[</span><span class="mi">150</span><span class="p">,</span><span class="mi">560</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">1720</span><span class="p">,</span><span class="mi">5230</span><span class="p">,</span><span class="mi">6890</span><span class="p">]</span>
<span class="n">right_censored</span> <span class="o">=</span> <span class="p">[</span><span class="mi">340</span><span class="p">,</span><span class="mi">1130</span><span class="p">,</span><span class="mi">2470</span><span class="p">,</span><span class="mi">4210</span><span class="p">]</span>
<span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">plotting_positions</span><span class="p">(</span><span class="n">failures</span><span class="o">=</span><span class="n">failures</span><span class="p">,</span><span class="n">right_censored</span><span class="o">=</span><span class="n">right_censored</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'x ='</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'y ='</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="sd">'''</span>
<span class="sd">x = [ 150  560  800 1720 5230 6890]</span>
<span class="sd">y = [0.06730769 0.1741453  0.28098291 0.40562678 0.61336657 0.82110636]</span>
<span class="sd">'''</span>
</pre></div>
</div>
<p>We can now plot the x and y values to obtain the plotting positions as shown in the image below.
The dashed blue line is an Exponential_1P distribution that has been fitted to the data.
This is just for illustrative purposes to show that the empirical CDF (the calculated y-values) and the CDF of the fitted model should roughly align.
Note that only the failures are plotted as the right censored data does not have an empirical estimate for the CDF.</p>
<img alt="_images/plotting_positions_4.png" src="_images/plotting_positions_4.png"/>
</section>
<section id="plotting-heuristics">
<h2>Plotting heuristics<a class="headerlink" href="#plotting-heuristics" title="Link to this heading"></a></h2>
<p>The plotting positions alogrithm uses the formula <span class="math notranslate nohighlight">\(y=\frac{i-a}{n+1-2a}\)</span>.
We can set the heuristic constant “a” to be any value from 0 to 1 and we will get different estimates.
Some of these are better than others, but the most popular is a = 0.3 (Benard’s approximation of the median ranks (typically just called “median rank”)) as this is generally the most accurate.</p>
<p>Published literature has been produced on the following Heuristics:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Heuristic (a)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Blom</p></td>
<td><p>0.375</p></td>
</tr>
<tr class="row-odd"><td><p>Benard (Median)</p></td>
<td><p>0.3</p></td>
</tr>
<tr class="row-even"><td><p>Hazen (Modified Kaplan Meier)</p></td>
<td><p>0.5</p></td>
</tr>
<tr class="row-odd"><td><p>Herd-Johnson (Mean)</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>Modal</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Beard</p></td>
<td><p>0.31</p></td>
</tr>
<tr class="row-even"><td><p>Gringorten</p></td>
<td><p>0.44</p></td>
</tr>
<tr class="row-odd"><td><p>Larsen</p></td>
<td><p>0.567</p></td>
</tr>
<tr class="row-even"><td><p>One-Third</p></td>
<td><p>1/3</p></td>
</tr>
<tr class="row-odd"><td><p>Cunane</p></td>
<td><p>0.4</p></td>
</tr>
</tbody>
</table>
<p>There is another modification to the <span class="math notranslate nohighlight">\(y=\frac{i-a}{n+1-2a}\)</span> formula to make it <span class="math notranslate nohighlight">\(y=\frac{i-a}{n+b}\)</span> which allows “b” to be independent of “a”.
The Kaplan Meier method uses this formula with a=0 and b=0 (making it <span class="math notranslate nohighlight">\(y=\frac{i}{n}\)</span>).
The <a class="reference external" href="https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot#Filliben's_estimate">Filliben estimate</a> also uses this method with further modifications to the first and last items of the CDF.</p>
<p>The formula of <span class="math notranslate nohighlight">\(y=\frac{i-a}{n+1-2a}\)</span> is not the only way to obtain plotting positions. There are other methods involving <a class="reference external" href="https://www.reliawiki.com/index.php/Parameter_Estimation#Beta_and_F_Distributions_Approach">Beta and F distributions</a>.</p>
<p>Within reliability, the heuristic constant “a” is accepted for all the probability plots as well as in the <a class="reference external" href="https://reliability.readthedocs.io/en/latest/Rank%20Adjustment.html">Nonparametric.RankAdjustment</a> method. The median ranks method is generally the default for most software (including in Reliasoft and MINITAB).</p>
</section>
<section id="transformations-for-pdf-sf-hf-chf">
<h2>Transformations for PDF, SF, HF, CHF<a class="headerlink" href="#transformations-for-pdf-sf-hf-chf" title="Link to this heading"></a></h2>
<p>The algorithms described above provide the empirical estimate of the CDF.
With some simple <a class="reference external" href="https://reliability.readthedocs.io/en/latest/Equations%20of%20supported%20distributions.html#relationships-between-the-five-functions">transformations</a> it is possible to obtain the empirical estimate of the SF and CHF.
Less commonly (but still mathematically possible) we can obtain the empirical estimate of the PDF and HF.
As you can see in the image below, the PDF and HF do not form smooth curves due to the need to take the derivative of a non-continuous function.
The following example illustrates how plot_points can be used to generate a scatterplot of the plotting positions for any of the five functions.
The Weibull distribution used to generate the data is also overlayed for comparison.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Distributions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Weibull_Distribution</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">reliability.Probability_plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_points</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">dist</span> <span class="o">=</span> <span class="n">Weibull_Distribution</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">random_samples</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">functions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'PDF'</span><span class="p">,</span><span class="s1">'CDF'</span><span class="p">,</span><span class="s1">'SF'</span><span class="p">,</span><span class="s1">'HF'</span><span class="p">,</span><span class="s1">'CHF'</span><span class="p">]</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">function</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">151</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">function</span> <span class="o">==</span> <span class="s1">'PDF'</span><span class="p">:</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">PDF</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">function</span> <span class="o">==</span> <span class="s1">'CDF'</span><span class="p">:</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">CDF</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">function</span> <span class="o">==</span> <span class="s1">'SF'</span><span class="p">:</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">SF</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">function</span> <span class="o">==</span> <span class="s1">'HF'</span><span class="p">:</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">HF</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">function</span> <span class="o">==</span> <span class="s1">'CHF'</span><span class="p">:</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">CHF</span><span class="p">()</span>
    <span class="n">plot_points</span><span class="p">(</span><span class="n">failures</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">func</span><span class="o">=</span><span class="n">function</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/plotting_positions_5.png" src="_images/plotting_positions_5.png"/>
<p>If you find any errors, think this needs to be explained better, or have any suggestions for improvements, please email me (<a class="reference external" href="mailto:alpha.reliability%40gmail.com">alpha<span>.</span>reliability<span>@</span>gmail<span>.</span>com</a>).</p>
</section>
</section>
</div>
</div>