### **[생성형 AI를 위한 프롬프트]**

너는 Python의 `reliability` 패키지를 전문적으로 활용하는 **최고 수준의 신뢰성 공학 전문가(Principal Reliability Engineer)이자 코드 아키텍트**이다. 너의 임무는 가속 수명 시험(ALT) 또는 일반 수명 시험 데이터를 분석하여, 데이터 전처리, 최적 수명분포 결정, 상세 수명분포 분석, 그리고 모수 동일성 검토까지 수행하는 모듈화되고 재사용 가능한 Python 코드를 생성하는 것이다.

**반드시 다음의 과업(Task)과 일반 요구사항 및 제약조건(General Requirements and Constraints)을 단계별로 생각하며(Let's think step by step) 논리적으로 수행해야 한다.**

---

### **과업 (Task)**

주어진 수명 데이터(CSV 파일 형식)를 분석하는 전체 과정을 자동화할 수 있는 Python 코드를 생성하라. 코드는 여러 개의 함수로 모듈화되어야 하며, 각 함수는 명확한 단일 책임 원칙(Single Responsibility Principle)을 따라야 한다. 최종 실행 코드는 사용자가 각 단계를 순차적으로 실행하며 중간 결과를 확인하고 다음 분석을 결정할 수 있도록 구성되어야 한다.

**입력 데이터 형식:**
CSV 파일 (`data.csv`)은 다음 컬럼을 포함한다:
- `time`: 고장 또는 관측 중단 시간 (필수)
- `status`: 데이터의 상태. 'failure'는 고장, 'censored'는 관측 중단 (필수)
- `stress` (선택 사항): 가속 수명 시험 데이터의 경우 스트레스 수준 (예: 온도, 전압 등). 이 컬럼이 없으면 일반 수명 분석으로 간주한다.

**생성할 코드의 구조 (모듈화된 함수):**

**1. `preprocess_and_summarize_data(file_path: str) -> dict`**
   - **기능:**
     - CSV 파일을 읽어 `pandas` DataFrame으로 변환한다.
     - `stress` 컬럼이 존재하면, 스트레스 수준별로 데이터를 그룹화한다. `stress` 컬럼이 없으면 'group_1'이라는 단일 그룹으로 처리한다.
     - 각 그룹에 대해 고장 데이터와 우측 관측 중단 데이터를 분리한다.
     - 각 그룹별 데이터 요약(총 샘플 수, 고장 수, 관측 중단 수, 관측 중단 비율)을 포함하는 요약 테이블을 생성하고 출력한다.
     - 그룹화된 데이터를 담은 딕셔너리를 반환한다. (예: `{'stress_100V': {'failures': [...], 'right_censored': [...]}, ...}`)
   - **산출물:**
     - 콘솔에 그룹별 데이터 요약 테이블 출력
     - 그룹화된 데이터 딕셔너리 반환

**2. `find_best_distribution(grouped_data: dict, distributions_to_fit: list) -> dict`**
   - **기능:**
     - `preprocess_and_summarize_data`로부터 받은 그룹화된 데이터를 입력받는다.
     - 사용자가 지정한 분포 목록(`distributions_to_fit`)에 대해 각 그룹별로 `reliability.Fitters.Fit_Everything` 함수를 활용하여 최적 분포를 찾는다.
     - 각 그룹에 대한 `Fit_Everything`의 결과 요약 테이블(분포명, 모수 추정치, Log-Likelihood, AICc, BIC, AD)을 출력한다.
     - 각 그룹별로 BIC(Bayesian Information Criterion)를 기준으로 가장 적합한 분포를 추천하고 그 이유를 간략히 설명한다.
     - 각 그룹별 `Fit_Everything`이 생성하는 모든 그림(확률도, 히스토그램, PP-Plot)을 지정된 폴더에 저장한다.
     - 분석 결과를 담은 딕셔너리를 반환한다. (예: `{'stress_100V': {'best_dist': 'Weibull_2P', 'results_df': DataFrame}, ...}`)
   - **산출물:**
     - 콘솔에 그룹별 최적 분포 분석 결과 및 추천 사유 출력
     - 그룹별 모든 분석 그림 파일 저장
     - 분석 결과 딕셔너리 반환

**3. `analyze_single_distribution(grouped_data: dict, group_name: str, distribution_name: str, b_lives: list, failure_prob_times: list) -> dict`**
   - **기능:**
     - 사용자가 `find_best_distribution` 결과를 보고 선택한 특정 그룹(`group_name`)과 분포(`distribution_name`)에 대해 상세 분석을 수행한다.
     - `reliability.Fitters`의 해당 분포 피팅 함수(예: `Fit_Weibull_2P`)를 사용하여 데이터를 분석한다.
     - 분석 결과(모수 추정치, 표준오차, 신뢰구간)를 상세 테이블로 출력한다.
     - 확률도(Probability Plot)를 생성하고 지정된 폴더에 저장한다.
     - 사용자가 요청한 신뢰성 척도를 계산하여 테이블로 출력한다:
       - 복수개의 B-수명 (예: B1, B10 수명)과 신뢰구간
       - 특정 시간에서의 누적 고장 확률(CDF)과 신뢰구간
     - 상세 분석 결과를 담은 딕셔너리를 반환한다.
   - **산출물:**
     - 콘솔에 상세 모수 추정 결과 테이블 출력
     - 콘솔에 계산된 신뢰성 척도 테이블 출력
     - 확률도 그림 파일 저장
     - 상세 분석 결과 딕셔너리 반환

**4. `check_parameter_homogeneity(analysis_results: dict, parameter_to_check: str)`**
   - **기능:**
     - 여러 스트레스 그룹에 대해 동일한 분포로 분석된 결과(`analysis_results` 딕셔너리)를 입력받는다.
     - 사용자가 지정한 모수(예: 와이블 분포의 형상모수 `beta`)의 그룹별 추정치와 신뢰구간을 테이블로 정리하여 출력한다.
     - 이 테이블을 바탕으로 그룹 간 모수가 통계적으로 동일한지 여부를 시각적으로 판단할 수 있는 신뢰구간 그림(Confidence Interval Plot)을 생성하고 저장한다.
     - 그림과 테이블을 바탕으로 "가속 수명 시험의 핵심 가정인 '형상모수 동일성'이 만족되는 것으로 보인다" 또는 "그룹 간 형상모수의 신뢰구간이 겹치지 않아 동일성 가정이 만족되지 않을 수 있으니 주의가 필요하다"와 같은 해석을 제공한다.
   - **산출물:**
     - 콘솔에 그룹별 모수 추정치 및 신뢰구간 비교 테이블 출력
     - 모수 신뢰구간 비교 그림 파일 저장
     - 모수 동일성에 대한 해석적 코멘트 출력

---

### **일반 요구사항 및 제약조건 (General Requirements and Constraints)**

1.  **라이브러리:** 오직 `reliability` 패키지만을 사용하여 수명 분석을 수행해야 한다. 데이터 처리를 위해 `pandas`, `numpy`를, 시각화를 위해 `matplotlib`를 함께 사용한다.
2.  **API 참조:** 내가 제공한 `reliability` 패키지의 API 문서를 철저히 참조하여, 실제로 존재하는 함수와 인자만을 사용해야 한다. 존재하지 않는 기능을 가정해서는 안 된다.
3.  **분석 대상 분포:** 수명분포 분석 시 **와이블(Weibull), 대수정규(Lognormal), 정규(Normal), 지수(Exponential)** 분포만을 고려한다.
4.  **코드 품질:**
    - 모든 함수에는 상세한 Docstring(함수 설명, 매개변수, 반환값 명시)과 Type Hinting을 포함해야 한다.
    - 코드의 각 중요 로직 라인에는 한글로 명확한 주석을 달아 가독성을 높여야 한다.
    - PEP 8 코딩 스타일 가이드라인을 준수해야 한다.
    - 예외 처리(try-except)를 통해 파일이 없거나 데이터 형식이 잘못된 경우 등 예상 가능한 오류를 처리해야 한다.
5.  **실행 및 산출물 관리:**
    - 최종 코드는 `if __name__ == "__main__":` 블록 내에서 각 분석 함수를 순차적으로 호출하는 예시를 보여주어야 한다. 사용자가 각 단계의 출력을 확인한 후 다음 단계로 넘어갈 수 있도록 구성한다.
    - 모든 실행 과정과 주요 결과를 `logging` 모듈을 사용하여 `analysis_log.log` 파일에 기록해야 한다.
    - 모든 생성된 테이블(DataFrame)과 그림은 `results`라는 하위 폴더에 체계적으로 저장되어야 한다. 파일명은 어떤 분석의 결과물인지 명확히 알 수 있도록 지정한다. (예: `stress_100V_probability_plot.png`, `parameter_homogeneity_beta.png`)
6.  **결과 해석:** 모든 표와 그림 출력 시, 해당 결과가 신뢰성 공학적으로 무엇을 의미하는지에 대한 상세하고 구체적인 해석을 한글로 제공해야 한다. 이는 최종 보고서 작성에 직접 활용될 수 있는 수준이어야 한다.
7.  **가속 수명 시험(ALT) 고려사항:**
    - `stress` 컬럼이 존재할 경우, 분석의 최종 목표는 '사용 스트레스 조건에서의 수명 예측'임을 명시하고, 이를 위해 '형상모수 동일성 검토'가 왜 중요한지에 대한 설명을 서두에 포함해야 한다.
    - `check_parameter_homogeneity` 함수는 ALT 분석의 핵심적인 사전 검토 단계임을 명확히 해야 한다.

이제, 위의 모든 요구사항을 만족하는 완벽한 Python 코드를 생성해줘.